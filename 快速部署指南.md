# å¿«é€Ÿéƒ¨ç½²æŒ‡å—

## ğŸš€ ä¸€é”®éƒ¨ç½²ï¼ˆæ¨èï¼‰

### ä½¿ç”¨è¿œç¨‹æ•°æ®åº“éƒ¨ç½²
ä½ çš„ `config.py` å·²ç»é…ç½®äº†è¿œç¨‹æ•°æ®åº“ç¯å¢ƒï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ï¼š

```bash
# 1. ä¸Šä¼ é¡¹ç›®åˆ°æœåŠ¡å™¨
scp -r ./image-convert-python root@your-server-ip:/tmp/

# 2. è¿æ¥æœåŠ¡å™¨
ssh root@your-server-ip

# 3. è¿›å…¥é¡¹ç›®ç›®å½•
cd /tmp/image-convert-python

# 4. è¿è¡Œè¿œç¨‹æ•°æ®åº“éƒ¨ç½²è„šæœ¬
chmod +x deploy/deploy_with_remote_db.sh
./deploy/deploy_with_remote_db.sh
```

### ä½¿ç”¨æœ¬åœ°æ•°æ®åº“éƒ¨ç½²
å¦‚æœä½ æƒ³åœ¨æœåŠ¡å™¨ä¸Šå®‰è£…æœ¬åœ°æ•°æ®åº“ï¼š

```bash
# 1. ä¸Šä¼ é¡¹ç›®åˆ°æœåŠ¡å™¨
scp -r ./image-convert-python root@your-server-ip:/tmp/

# 2. è¿æ¥æœåŠ¡å™¨
ssh root@your-server-ip

# 3. è¿›å…¥é¡¹ç›®ç›®å½•
cd /tmp/image-convert-python

# 4. è¿è¡Œä¸€é”®éƒ¨ç½²è„šæœ¬
chmod +x deploy/one_click_deploy.sh
./deploy/one_click_deploy.sh
```

## ğŸ“‹ å½“å‰é…ç½®ä¿¡æ¯

æ ¹æ®ä½ çš„ `config.py` æ–‡ä»¶ï¼Œå½“å‰é…ç½®å¦‚ä¸‹ï¼š

- **æ•°æ®åº“åœ°å€**: `1.94.137.69:3306`
- **æ•°æ®åº“å**: `image_convert_db`
- **æ•°æ®åº“ç”¨æˆ·**: `root`
- **Redisåœ°å€**: `1.94.137.69:6379`
- **Rediså¯†ç **: `foobared`

## ğŸ”§ éƒ¨ç½²è¿‡ç¨‹è¯´æ˜

### è¿œç¨‹æ•°æ®åº“éƒ¨ç½²æµç¨‹
1. âœ… **è·³è¿‡æœ¬åœ°æ•°æ®åº“å®‰è£…** - ç›´æ¥ä½¿ç”¨è¿œç¨‹æ•°æ®åº“
2. âœ… **è·³è¿‡æœ¬åœ°Rediså®‰è£…** - ç›´æ¥ä½¿ç”¨è¿œç¨‹Redis
3. âœ… **å®‰è£…Pythonå’ŒNginx** - è¿è¡Œåº”ç”¨å’Œåå‘ä»£ç†
4. âœ… **æµ‹è¯•æ•°æ®åº“è¿æ¥** - ç¡®ä¿èƒ½è¿æ¥åˆ°è¿œç¨‹æ•°æ®åº“
5. âœ… **åˆå§‹åŒ–æ•°æ®åº“è¡¨** - åœ¨è¿œç¨‹æ•°æ®åº“ä¸­åˆ›å»ºè¡¨ç»“æ„
6. âœ… **é…ç½®Nginx** - è®¾ç½®åå‘ä»£ç†å’Œé™æ€æ–‡ä»¶æœåŠ¡
7. âœ… **å¯åŠ¨æœåŠ¡** - å¯åŠ¨åº”ç”¨å’Œå®šæ—¶ä»»åŠ¡

### æœ¬åœ°æ•°æ®åº“éƒ¨ç½²æµç¨‹
1. âœ… **å®‰è£…MySQL** - åœ¨æœåŠ¡å™¨ä¸Šå®‰è£…MySQL
2. âœ… **å®‰è£…Redis** - åœ¨æœåŠ¡å™¨ä¸Šå®‰è£…Redis
3. âœ… **åˆ›å»ºæ•°æ®åº“** - åˆ›å»ºæœ¬åœ°æ•°æ®åº“å’Œç”¨æˆ·
4. âœ… **ä¿®æ”¹é…ç½®** - æ›´æ–°config.pyä½¿ç”¨æœ¬åœ°æ•°æ®åº“
5. âœ… **å®‰è£…Pythonå’ŒNginx** - è¿è¡Œåº”ç”¨å’Œåå‘ä»£ç†
6. âœ… **åˆå§‹åŒ–æ•°æ®åº“** - åˆ›å»ºè¡¨ç»“æ„
7. âœ… **é…ç½®Nginx** - è®¾ç½®åå‘ä»£ç†
8. âœ… **å¯åŠ¨æœåŠ¡** - å¯åŠ¨æ‰€æœ‰æœåŠ¡

## ğŸ¯ æ¨èæ–¹æ¡ˆ

**å»ºè®®ä½¿ç”¨è¿œç¨‹æ•°æ®åº“éƒ¨ç½²**ï¼Œå› ä¸ºï¼š

1. âœ… **é…ç½®ç®€å•** - ä¸éœ€è¦ä¿®æ”¹config.py
2. âœ… **éƒ¨ç½²å¿«é€Ÿ** - è·³è¿‡æ•°æ®åº“å®‰è£…æ­¥éª¤
3. âœ… **èµ„æºèŠ‚çœ** - ä¸éœ€è¦åœ¨æœåŠ¡å™¨ä¸Šè¿è¡Œæ•°æ®åº“
4. âœ… **ç»´æŠ¤æ–¹ä¾¿** - æ•°æ®åº“é›†ä¸­ç®¡ç†

## ğŸ“Š éƒ¨ç½²åéªŒè¯

éƒ¨ç½²å®Œæˆåï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼éªŒè¯ï¼š

```bash
# æ£€æŸ¥æœåŠ¡çŠ¶æ€
systemctl status image-convert
systemctl status image-convert-scheduler
systemctl status nginx

# æµ‹è¯•APIæ¥å£
curl http://localhost/health
curl http://localhost/docs

# æŸ¥çœ‹æ—¥å¿—
journalctl -u image-convert -f
```

## ğŸ” å®‰å…¨é…ç½®

éƒ¨ç½²å®Œæˆåï¼Œå»ºè®®è¿›è¡Œä»¥ä¸‹å®‰å…¨é…ç½®ï¼š

1. **ç”³è¯·SSLè¯ä¹¦**
```bash
certbot --nginx -d your-domain.com
```

2. **é…ç½®é˜²ç«å¢™**
```bash
ufw allow 22
ufw allow 80
ufw allow 443
ufw enable
```

3. **å®šæœŸå¤‡ä»½**
```bash
# å¤‡ä»½è„šæœ¬å·²è‡ªåŠ¨åˆ›å»º
/var/www/image-convert/backup.sh
```

## ğŸš¨ æ•…éšœæ’é™¤

å¦‚æœéƒ¨ç½²è¿‡ç¨‹ä¸­é‡åˆ°é—®é¢˜ï¼š

1. **æ£€æŸ¥æ•°æ®åº“è¿æ¥**
```bash
python -c "from tools.database.database import engine; print('OK' if engine.connect() else 'FAIL')"
```

2. **æ£€æŸ¥æœåŠ¡æ—¥å¿—**
```bash
journalctl -u image-convert --no-pager
```

3. **æ£€æŸ¥Nginxé…ç½®**
```bash
nginx -t
```

4. **é‡å¯æœåŠ¡**
```bash
systemctl restart image-convert
systemctl restart nginx
```

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚æœé‡åˆ°é—®é¢˜ï¼Œå¯ä»¥ï¼š

1. æŸ¥çœ‹è¯¦ç»†æ—¥å¿—ï¼š`journalctl -u service-name -f`
2. æ£€æŸ¥é…ç½®æ–‡ä»¶ï¼š`/var/www/image-convert/config.py`
3. æµ‹è¯•æ•°æ®åº“è¿æ¥ï¼šä½¿ç”¨é¡¹ç›®ä¸­çš„æµ‹è¯•è„šæœ¬
4. æŸ¥çœ‹Nginxæ—¥å¿—ï¼š`tail -f /var/log/nginx/error.log`

ç°åœ¨ä½ å¯ä»¥é€‰æ‹©é€‚åˆçš„éƒ¨ç½²æ–¹å¼å¼€å§‹éƒ¨ç½²äº†ï¼ğŸ‰
